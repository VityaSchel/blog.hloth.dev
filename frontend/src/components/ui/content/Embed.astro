---
/**
 * Example usage:
 *
 * <Embed url="https://www.youtube.com/embed/dQw4w9WgXcQ">Caption</Embed>
 * <Embed url="https://example.org" service="Example" ar={16/9} />
 */

import IsolatedIframe from "$ui/IsolatedIframe.svelte";

interface Props {
	url: string;
	service?: string;
	ar?: number;
}

let { url, service: serviceVar, ar = 16 / 9 } = Astro.props;

let service = serviceVar;
if (!service) {
	const serviceUrl = new URL(url);
	if (
		serviceUrl.hostname === "www.youtube.com" ||
		serviceUrl.hostname === "youtu.be"
	) {
		service = "YouTube";
	} else if (
		serviceUrl.hostname === "twitter.com" ||
		serviceUrl.hostname === "www.twitter.com" ||
		serviceUrl.hostname === "x.com" ||
		serviceUrl.hostname === "www.x.com"
	) {
		service = "Twitter";
	} else {
		throw new Error("Service argument must be provided for this URL");
	}
}
---

<IsolatedIframe
	{url}
	aspectRatio={ar}
	title={`Embedded ${service} frame`}
	client:visible
>
	<slot />
</IsolatedIframe>
