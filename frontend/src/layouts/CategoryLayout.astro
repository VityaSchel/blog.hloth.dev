---
import { getCollection } from "astro:content";
import { CATEGORIES, SITE_TITLE, type CategoryId } from "$consts";
import BaseLayout from "$layouts/BaseLayout.astro";
import PostsLayout from "$layouts/PostsLayout.astro";

interface Props {
	categorySlug: CategoryId;
}
const { categorySlug } = Astro.props;

const posts = await getCollection(
	"blog",
	({ data }) => data.category === categorySlug,
);

const sorted = posts.sort(
	(a, b) => b.data.createdAt.valueOf() - a.data.createdAt.valueOf(),
);
---

<BaseLayout
	title={`${CATEGORIES[categorySlug].plural} @ ${SITE_TITLE}`}
	activeCategory={categorySlug}
>
	<PostsLayout posts={sorted} />
</BaseLayout>
